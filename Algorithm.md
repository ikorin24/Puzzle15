# アルゴリズムとその実装

## 概要

- 全体像
- データ構造
- 完成可能なアルゴリズム
- 完成形の判別
- 移動可能なセルの判別

## 全体像

15パズルの全体的な流れは以下のようになっている。

![図1](https://github.com/ikorin24/Puzzle15/blob/image/img/fig1.png)

## データ構造

そもそも、セル(15パズルの1つのマスのこと)のデータ構造はいろいろ考えられるが、
今回1次元配列に持つことにする。2次元配列はいろいろ面倒くさい。

1次元配列にセルを持つというのは、左上のセルから順に配列として持つという意味。

![図2](https://github.com/ikorin24/Puzzle15/blob/image/img/fig2.png)

セル数は15。

## 完成可能なアルゴリズム

実質的な内容は[ここに書いた](http://ikorin2.hatenablog.jp/entry/2019/06/15/025528)。

要するに、完成形を用意して、適当な偶数回(例えば100回)

2つのセルを入れ替えた形を初期状態とすれば、それが完成可能な初期状態である。

## 完成形の判別

パズルの完成を判断するためには、現在の状態が完成形なのかを判別する必要がある。

まず、セルがクラス(C言語で言うところの構造体)だとして、セルは

- x座標
- y座標
- 自分自身のパズルの数字

を持つように作ったとする。

パズルはこのセルを15個配列として持っている。
つまり、配列のi番目の要素の数字は```i+1```である。

配列のi番目の要素は

- x座標 = (iを4で割ったあまり)
- y座標 = (iを4で割った商)

にある時、正しい位置にいると言える。

例えば、配列の6番目の要素(数字は```7```)は

- x座標 = 2 (6を4で割ったあまり)
- y座標 = 1 (6を4で割った商)

が正解の位置である。

|  | x = 0 | x = 1 | x = 2 | x = 3 |
| --- | --- | --- | --- | --- |
| y = 0 | | | | |
| y = 1 | | 6 | | |
| y = 2 | | | | |
| y = 3 | | | | |

15個すべての場所が正しい位置にある時が、パズルが完成している状態である。

## 移動可能なセルの判別

セルをクリックした時そのセルを移動できるのは、隣に空きマスがある時である。

隣に空きマスがあるというのを数式で表す必要がある。

クリックされたセルの座標を```x = a```, ```y = b```
空きマスの座標を```x = p```, ```y = q```とすると、

```vb
Math.Abs(p - a) + Math.Abs(q - y) = 1
```

の時、移動可能である。

ただし```Math.Abs(n)```はnの絶対値を表す

言葉で書くと、空きマスとクリックしたマスのx座標の差 と 空きマスとクリックしたマスのy座標の差 が1マスの時、移動可能ということである。
